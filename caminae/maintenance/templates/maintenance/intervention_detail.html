{% extends "mapentity/entity_detail.html" %}
{% load i18n field_verbose_name %}

{% block detailspanel %}
    {{ block.super }}
    <table class="table-striped table-bordered table">
        {% include "mapentity/trackinfo_fragment.html" %}
        <tr>
            <th>{{ intervention|verbose:"date" }}</th>
            <td>{{ intervention.date }}</td>
        </tr>
        <tr>
            <th>{{ intervention|verbose:"stake" }}</th>
            <td>{{ intervention.stake|default:_("None") }}</td>
        </tr>
        <tr>
            <th>{{ intervention|verbose:"date" }}</th>
            <td>{{ intervention.date }}</td>
        </tr>
        <tr>
            <th>{{ intervention|verbose:"project" }}</th>
            <td>{{ intervention.project }}</td>
        </tr>
        <tr>
            <th>{% trans "Mandays" %}</th>
            <td>
                {% for md in intervention.manday_set.all %}
                    {% if forloop.first %}<ul>{% endif %}
                    <li>
                    {% blocktrans with md.nb_days as nb_days and md.job as job %}
                     {{ job }}: {{ nb_days }} days
                    {% endblocktrans %}
                    </li>
                    {% if forloop.last %}</ul>{% endif %}
                {% endfor %}
                <p>{% trans "Total:" %} {{ intervention.total_manday }} {% trans "manday" %}{{ intervention.total_manday|pluralize }}</p>
                <p>{% trans "Total cost:" %} {{ intervention.total_cost|floatformat:2 }} &euro;</p>
            </td>
        </tr>
    </table>

    <h3>{% trans "Management" %}</h3>
    <table class="table">
        {% if intervention.topology %}
            {% include "core/aggregations_list_fragment.html" with object=intervention.topology %}
        {% endif %}
        <tr>
            <th>{% trans "Related Project" %}</th>
            <td>{% if intervention.project %} {{ intervention.project.name_display|safe }}
                {% else %} <span class="none">{% trans "None" %}</span>
                {% endif %}
            </td>
        </tr><tr>
            <th>{% trans "Related infrastructure" %}</th>
            <td>{% if intervention.is_infrastructure %} {{ intervention.infrastructure.name_display|safe }}
                {% else %} <span class="none">{% trans "None" %}</span>
                {% endif %}
            </td>
        </tr><tr>
            <th>{% trans "Related signage" %}</th>
            <td>{% if intervention.is_signage %} {{ intervention.infrastructure.name_display|safe }}
                {% else %} <span class="none">{% trans "None" %}</span>
                {% endif %}
            </td>
        </tr>
    </table>
{% endblock detailspanel %}
