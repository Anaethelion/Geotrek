{% extends "mapentity/entity_detail.html" %}
{% load i18n static field_verbose_name %}

{% block extrahead %}
    {{ block.super }}
    <script type="text/javascript" src="{% static "js/jquery.sparkline.js" %}"></script>
{% endblock extrahead %}


{% block detailspanel %}
    {{ block.super }}
    <table class="table-striped table-bordered table">
        <tr>
            <th>{{ path|verbose:"valid" }}</th>
            <td>{{ path.valid|yesno:_("Yes,No") }}</td>
        </tr><tr>
            <th>{{ path|verbose:"name" }}</th>
            <td>{{ path.name|default:_("None") }}</td>
        </tr><tr>
            <th>{{ path|verbose:"comments" }}</th>
            <td>{{ path.comments|default:_("None")  }}</td>
        </tr><tr>
            <th>{{ path|verbose:"date_insert" }}</th>
            <td>{{ path.date_insert }}</td>
        </tr><tr>
            <th>{{ path|verbose:"date_update" }}</th>
            <td>{{ path.date_update }}</td>
        </tr><tr>
            <th>{{ path|verbose:"length" }}</th>
            <td>{{ path.length|stringformat:".2f" }} {% trans "meters" %}</td>
        </tr><tr>
            <th>{{ path|verbose:"ascent" }}</th>
            <td>{{ path.ascent }}</td>
        </tr><tr>
            <th>{{ path|verbose:"descent" }}</th>
            <td>{{ path.descent }}</td>
        </tr><tr>
            <th>{{ path|verbose:"min_elevation" }}</th>
            <td>{{ path.min_elevation }}</td>
        </tr><tr>
            <th>{{ path|verbose:"max_elevation" }}</th>
            <td>{{ path.max_elevation }}</td>
        </tr><tr>
            <th>{{ path|verbose:"trail" }}</th>
            <td>{{ path.trail_display|safe }}</td>
        </tr><tr>
            <th>{{ path|verbose:"datasource" }}</th>
            <td>{{ path.datasource|default:_("None") }}</td>
        </tr><tr>
            <th>{{ path|verbose:"stake" }}</th>
            <td>{{ path.stake|default:_("None") }}</td>
        </tr><tr>
            <th>{{ path|verbose:"usages" }}</th>
            <td>
                {% for usage in  path.usages.all %}
                    {% if forloop.first %}<ul>{% endif %}
                    <li> {{ usage }} </li>
                    {% if forloop.last %}</ul>{% endif %}
                {% empty %}
                    {% trans "None" %}
                {% endfor %}
            </td>
        </tr><tr>
            <th>{{ path|verbose:"networks" }}</th>
            <td>
                {% for network in  path.networks.all %}
                    {% if forloop.first %}<ul>{% endif %}
                    <li> {{ network }} </li>
                    {% if forloop.last %}</ul>{% endif %}
                {% empty %}
                    {% trans "None" %}
                {% endfor %}
            </td>
        </tr>
    </table>
{% endblock detailspanel %}


{% block mappanel %}
    {{ block.super }}
	<div id="altitudegraph">
		<h2>{% trans "Altitude profile" %}</h2>
		<p class="axislabel">{% trans "Altitude (m)" %}</p>
		<span id="profilealtitude"></span> <span class="axislabel" style="position:relative; top:85px">{% trans "Distance (m)" %}</span>
		<p id="mouseoverprofil" class="axislabel" >&nbsp;</p>
	</div>

	<div class="span11"></div><!-- clear -->

    <script type="text/javascript">
		$(function() {
			$.getJSON("{% url core:path_profile path.pk %}", function(data) {
				$('#profilealtitude').sparkline(data.profile, {tooltipSuffix: ' m', width: 300, height: 100});
				$('#profilealtitude').bind('sparklineRegionChange', function(ev) {
					var sparkline = ev.sparklines[0],
						region = sparkline.getCurrentRegionFields();
						value = region.y;
					$('#mouseoverprofil').text(Math.round(region.x) +" m");
				}).bind('mouseleave', function() {
					$('#mouseoverprofil').text('');
				});
			});
		});
	</script>
{% endblock mappanel %}
