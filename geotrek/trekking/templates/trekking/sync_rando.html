{% extends "mapentity/base.html" %}
{% load static crispy_forms_tags %}
{% load i18n %}

{% block extrahead %}
	<script type="text/javascript">
		$(function(){
			$('#form-sync').submit(function() {
				return confirm("{% trans 'Are you sure you want to sync ?' %}");
			});
			
			{% if request.GET.job %}
			$.get("{% url 'trekking:sync_randos_state' %}?job={{ request.GET.job }}",
			      function(response) {
				      if(response.exc_type){
				    	  $('#results').text(response.exc_type + " : " + response.exc_message);
				      }
				      else {
			    	  	alert(response);
				      }
			      }
			);
			{% endif %}
		});
	</script>

{% endblock extrahead %}

{% block toolbar %}
{% endblock toolbar %}

{% block mainpanel %}

	<div id="sync-div" class="span3 offset2">
	    <h3>{% trans "Launch a sync_rando" %}</h3>
		{% block mainform %}
			{% crispy form form.helper %}
		{% endblock mainform %}
		{{ request.GET.job }}
	</div>
	
	<div id="progress-bars" class="span5">
	</div>

	<div id="results">
	</div>
	
	<script id="import-template" type="text/template">
	<div id="progress-tpl">
		<button type="button" class="close" data-dismiss="alert">&times;</button>
		<div class="description">
			<span class="parser"></span>
			<span class="filename">
			</span>
		</div>
		<div class="pull-left">
			<span></span>
		</div>
		<div class="progress progress-striped active">
			<div class="bar"></div>
		</div>
		<div class="alert">
			<span></span>
		</div>
		<hr></hr>
	</div>
	</script>
	
{% endblock mainpanel %}
